<html>
<head>
	<title>Het Rijksmuseum Memory Spel</title>
	<link rel="stylesheet" href="css/style.css"></link>
	<link href='http://fonts.googleapis.com/css?family=Cardo' rel='stylesheet' type='text/css'>
</head>
<body>

<div id="settings" class="msgBlock">
	<h1>Het Rijksmuseum Memory Spel</h1>

	<div class="items">
		<input id="qry" class="inputBtn" placeholder="bijv. rembrandt, van gogh"/>
	</div>
	<div class="items msg" style="display: none;">
		<div class="bodytext">Geen resultaten gevonden. Probeer opnieuw.</div>
	</div>
	<div id="play" class="submitBtn">play</div>
</div>

<div id="final" class="msgBlock">
	<h1 class="win">Yah! Je hebt gewonnen.</h1>
	<h1 class="lose">Jammer! Je hebt verloren.</h1>

	<div id="replay" class="submitBtn">opnieuw</div>
</div>

<script src="http://code.jquery.com/jquery-1.6.4.js"></script>
<script src="js/Sprite3D.min.js"></script>
<script src="js/stats.js"></script>
<script src="js/Tween.js"></script>
<script src="js/utils.js"></script>
<script src="js/memory.js"></script>
<script src="js/card.js"></script>
<script src="js/settings.js"></script>
<script>

$('#play').click(function(){
	$('#settings .msg').hide();

	var qry = $('#qry').val();
	$.getJSON("http://nbl01.local/rijks/json.php?qry="+qry+"&callback=?", {}, function(data) {
		// console.log(data.length);
		if(data.length >= 10){
			$('#settings').hide();
			init(data);
		} else {
			//show warning not enough records found
			$('#settings .msg').show();
		}
	});
});

$('#replay').click(function(e){
	document.reload();
});

var Stage = Sprite3D.createCenteredContainer();
var Sprites = [];
var game;

function init(set) {
		console.log(set.length);

	var cards = [];
	var cols = 5;
	var rows = ~~(set.length / cols);
	for (var s=0 ; s<set.length ; s++)
	{
		var obj = set[s];

		obj.found = false;
		var c1 = new Card(obj);
		var c2 = new Card(obj);

		c1.other = c2;
		c2.other = c1;

		cards.push( c1 );
		cards.push( c2 );
	}

	game = new Memory(cards);
}

function update(dt) {
	Tween.tick( dt );
	//Stage.updateChildrenAll();
	//stats.update();
}

var prevDate = new Date;
var loop = function() {
	var now = new Date();

	update(now - prevDate);

	requestAnimFrame(loop)
	prevDate = now;
}

// var stats = new Stats();

// // Align top-left
// stats.domElement.style.position = 'absolute';
// stats.domElement.style.left = '0px';
// stats.domElement.style.top = '0px';

// document.body.appendChild(stats.domElement);


loop();


</script>
</body>
</html>
